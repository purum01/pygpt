<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/components/prism-python.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="style2.css">

<h1 class="title">ê³µë¬¸ ìƒì„±í•˜ê¸°</h1>

<div class="faq-container">
    <!-- ì§ˆë¬¸ ì˜ì—­ -->
    <div class="faq-section">
        <div class="faq-question" onclick="toggleFaq(this)">
            <img src="question.png" width="34px" height="34px">
            ì§ˆë¬¸
            <i class="fas fa-chevron-down"></i>
        </div>
        <div class="faq-answer">
            <button class="copy-btn" onclick="copyCode('source-question')">ğŸ“‹ Copy</button>
            <pre><code id="source-question">
ë‹¤ìˆ˜ì˜ ê³ ê°ì‚¬ì— ë™ì¼í•œ ë‚´ìš©ì˜ ê³µë¬¸ì„ ì‘ì„±í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ë‹¤ìŒ ì¡°ê±´ì— ë”°ë¼ íŒŒì´ì¬ ì½”ë“œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.

# ì œëª©
ë™ì¼í•œ ë‚´ìš©ì„ ê³µë¬¸ ì‘ì„±

#ì¡°ê±´
1. ê³ ê°ì‚¬ ëª…ë‹¨ì€ customers.txt ì— ì €ì¥ë˜ì–´ ìˆìŒ
2. ì‘ì„±í•  ê³µë¬¸ í…œí”Œë¦¿ì€ template.docx ì„ ì‚¬ìš©í•¨
3. template.docxì—ì„œ { } ë¶€ë¶„ì„ ë‹¤ìŒê³¼ ê°™ì´ ëŒ€ì²´í•¨ 
    1) {company}ëŠ” "ì£¼ì‹íšŒì‚¬ í‘¸ë¥¸í•˜ëŠ˜" ë¡œ ëŒ€ì²´
    2) {number} ëŠ”"2023-12-Axx"  í˜•ì‹ì´ë©° xx ë¶€ë¶„ì— 01ë¶€í„° ì‹œì‘í•´ì„œ 1ì”© ì¦ê°€ë˜ëŠ” ì¼ë ¨ë²ˆí˜¸ ë¶€ì—¬
    3) {receiver}ëŠ” customers.txtì— ì €ì¥ëœ ê° ê³ ê°ì‚¬ ì´ë¦„ ë¶€ì—¬
    4) {sender}ëŠ” "í‘¸ë¥¸í•˜ëŠ˜(ì£¼) ë°ì´í„°ë¶„ì„íŒ€" ìœ¼ë¡œ ëŒ€ì²´
    5) {title}ì€ "ë°ì´í„° ì²˜ë¦¬ ë° ë¶„ì„ì„ ìœ„í•œ ê´€ë ¨ ìë£Œ ìš”ì²­"ìœ¼ë¡œ ëŒ€ì²´
4. ìœ„ì˜ ë‚´ìš©ìœ¼ë¡œ ì²˜ë¦¬ëœ  docx íŒŒì¼ì„ ê³ ê°ì‚¬ ìˆ˜ë§Œí¼ "output" í´ë”ì— ìƒì„±                    
            </code></pre>
        </div>
    </div>

    <!-- ë‹µë³€ ì˜ì—­ -->
    <div class="faq-section">
        <div class="faq-question" onclick="toggleFaq(this)">
            <img src="gpt.png" width="34px" height="34px">
            ë‹µë³€
            <i class="fas fa-chevron-down"></i>
        </div>
        <div class="faq-answer">
<pre><code class="language-python" >pip install python-docx</code></pre>
                    
            <button class="copy-btn" onclick="copyCode('source-code')">ğŸ“‹ Copy</button>
            <pre><code id="source-code" class="language-python">
import os
from docx import Document  # docx íŒŒì¼ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬

# 1. ê³ ê°ì‚¬ ëª…ë‹¨ê³¼ í…œí”Œë¦¿ íŒŒì¼ ê²½ë¡œ ì„¤ì •
customers_file = 'customers.txt'  # ê³ ê°ì‚¬ ëª…ë‹¨ íŒŒì¼ ê²½ë¡œ
template_file = 'template.docx'  # í…œí”Œë¦¿ íŒŒì¼ ê²½ë¡œ
output_folder = 'output'  # ê²°ê³¼ íŒŒì¼ì„ ì €ì¥í•  í´ë”

# 2. ê³ ì •ëœ ê°’ ì„¤ì •
company_value = "ì£¼ì‹íšŒì‚¬ í‘¸ë¥¸í•˜ëŠ˜"  # íšŒì‚¬ëª…
sender_value = "í‘¸ë¥¸í•˜ëŠ˜(ì£¼) ë°ì´í„°ë¶„ì„íŒ€"  # ë°œì‹ ì
title_value = "ë°ì´í„° ì²˜ë¦¬ ë° ë¶„ì„ì„ ìœ„í•œ ê´€ë ¨ ìë£Œ ìš”ì²­"  # ì œëª©

# 3. ì¶œë ¥ í´ë”ê°€ ì—†ìœ¼ë©´ ìƒì„±
if not os.path.exists(output_folder):
    os.makedirs(output_folder)

# 4. ê³ ê°ì‚¬ ëª…ë‹¨ íŒŒì¼ì„ ì½ì–´ì˜´
with open(customers_file, 'r', encoding='utf-8') as file:
    customers = [line.strip() for line in file.readlines()]  # ê° ì¤„ì„ ì½ì–´ ê³ ê°ì‚¬ ë¦¬ìŠ¤íŠ¸ ìƒì„±

# 5. í…œí”Œë¦¿ì„ ê¸°ë°˜ìœ¼ë¡œ ê³µë¬¸ì„ ì‘ì„±í•˜ëŠ” í•¨ìˆ˜
def generate_document(customer, doc_number):
    # í…œí”Œë¦¿ íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
    doc = Document(template_file)
    
    # í…œí”Œë¦¿ ë‚´ì˜ { } ë¶€ë¶„ì„ ì›í•˜ëŠ” ê°’ìœ¼ë¡œ ëŒ€ì²´
    for paragraph in doc.paragraphs:  # ë¬¸ì„œì˜ ëª¨ë“  ë¬¸ë‹¨ì„ ë°˜ë³µí•˜ì—¬ ì²˜ë¦¬
        if '{company}' in paragraph.text:
            paragraph.text = paragraph.text.replace('{company}', company_value)  # íšŒì‚¬ëª… ëŒ€ì²´
        if '{number}' in paragraph.text:
            paragraph.text = paragraph.text.replace('{number}', doc_number)  # ë¬¸ì„œë²ˆí˜¸ ëŒ€ì²´
        if '{receiver}' in paragraph.text:
            paragraph.text = paragraph.text.replace('{receiver}', customer)  # ê³ ê°ì‚¬ ì´ë¦„ ëŒ€ì²´
        if '{sender}' in paragraph.text:
            paragraph.text = paragraph.text.replace('{sender}', sender_value)  # ë°œì‹ ì ëŒ€ì²´
        if '{title}' in paragraph.text:
            paragraph.text = paragraph.text.replace('{title}', title_value)  # ì œëª© ëŒ€ì²´
    
    # ê³µë¬¸ íŒŒì¼ ì´ë¦„ì„ 'ê³ ê°ì‚¬ëª…_ê³µë¬¸.docx' í˜•ì‹ìœ¼ë¡œ ì§€ì •
    output_filename = f"{output_folder}/{customer}_ê³µë¬¸.docx"
    
    # íŒŒì¼ ì €ì¥
    doc.save(output_filename)
    print(f"{output_filename} íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.")  # íŒŒì¼ ìƒì„± ì—¬ë¶€ë¥¼ ì½˜ì†”ì— ì¶œë ¥

# 6. ê° ê³ ê°ì‚¬ë³„ë¡œ ê³µë¬¸ì„ ìƒì„±
for i, customer in enumerate(customers, start=1):  # ê³ ê°ì‚¬ ëª©ë¡ì„ ë°˜ë³µí•˜ë©° ì²˜ë¦¬
    # ë¬¸ì„œë²ˆí˜¸ëŠ” "2023-12-A01", "2023-12-A02" í˜•ì‹ìœ¼ë¡œ ìƒì„±
    doc_number = f"2023-12-A{str(i).zfill(2)}"  # 01ë¶€í„° ì‹œì‘í•˜ì—¬ 1ì”© ì¦ê°€í•˜ëŠ” ì¼ë ¨ë²ˆí˜¸ ìƒì„±
    generate_document(customer, doc_number)  # ê° ê³ ê°ì‚¬ì— ë§ëŠ” ê³µë¬¸ ìƒì„±
                  
            </code></pre>
        </div>
    </div>
</div>

<script>
function copyCode(elementId) {
    // í•´ë‹¹ ìš”ì†Œì˜ í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ê³  ë³µì‚¬í•©ë‹ˆë‹¤.
    var codeElement = document.getElementById(elementId);
    var range = document.createRange();
    range.selectNodeContents(codeElement);
    var selection = window.getSelection();
    selection.removeAllRanges();
    selection.addRange(range);

    try {
        document.execCommand('copy');
    } catch (err) {
        alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
    
    // ì„ íƒ í•´ì œ
    selection.removeAllRanges();
}

function toggleFaq(element) {
    // ë“œë¡­ë‹¤ìš´ í† ê¸€ ê¸°ëŠ¥
    var answer = element.nextElementSibling;
    var icon = element.querySelector('i');
    if (answer.style.display === "block") {
        answer.style.display = "none";
        icon.classList.remove('fa-chevron-up');
        icon.classList.add('fa-chevron-down');
    } else {
        answer.style.display = "block";
        icon.classList.remove('fa-chevron-down');
        icon.classList.add('fa-chevron-up');
    }
}
</script>
